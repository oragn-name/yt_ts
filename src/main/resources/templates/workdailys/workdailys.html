<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head th:include="common/head :: header">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body class="easyui-layout">
<table id="tb2" class="easyui-datagrid" title="" style="width:1260px;height:255px;"  border="0"
           data-options="rownumbers:true,pagination:true,url:'/workdailys/getItemData.do',singleSelect:true,method:'get',toolbar:'#toolbar2'">
        <thead>
            <tr>
            	<th data-options="field:'ck',checkbox:true"></th>
            	<th data-options="field:'proId',width:100,align:'center',sortable:'true',hidden:'true'">proId</th>
            	<th data-options="field:'pcId',width:100,align:'center',sortable:'true',hidden:'true'">pcId</th>
            	<th data-options="field:'proNumber',width:100,align:'center',sortable:'true'">工号</th>
            	<th data-options="field:'proSnapNumber',width:100,align:'center',sortable:'true'">临时工号</th>
            	<th data-options="field:'proSerialNumber',width:100,align:'center',sortable:'true'">序号</th>
            	<th data-options="field:'proName',width:100,align:'center',sortable:'true'">工程名称</th>
            	<th data-options="field:'pcDeptName',width:100,align:'center',sortable:'true'">施工单位</th>
            	<th data-options="field:'pcWorkers',width:100,align:'center',sortable:'true'">施工人员</th>
            	<th data-options="field:'pcPhone',width:100,align:'center',sortable:'true'">电话</th>
            	<!-- <th data-options="field:'pcWeekPlan',width:100,align:'center',sortable:'true'">周计划</th>
            	<th data-options="field:'pcMonthPlan',width:100,align:'center',sortable:'true'">月计划</th> -->
            	<th data-options="field:'pcRemark',width:300,align:'center',sortable:'true'">备注</th>
            	<th data-options="field:'createUser',width:100,align:'center',sortable:'true'">创建人</th>
            	<th data-options="field:'createTime',width:100,align:'center',sortable:'true'">创建时间</th>
            	<!-- <th data-options="field:'id',width:100,align:'center',sortable:'true',hidden:'true'">id</th>
            	<th data-options="field:'proGauge',width:80,align:'center',sortable:'true',formatter:function(value,row){
            							if (value == 1) return '是';
	                                    return '否';
	                		  }">测量定线</th>
	            <th data-options="field:'proNumber',width:100,align:'center',sortable:'true'">工号</th>
            	<th data-options="field:'proSnapNumber',width:100,align:'center',sortable:'true'">临时工号</th>
            	<th data-options="field:'proSerialNumber',width:100,align:'center',sortable:'true'">序号</th>
            	<th data-options="field:'proName',width:100,align:'center',sortable:'true'">工程名称</th>
            	<th data-options="field:'proJobTypeName',width:100,align:'center',sortable:'true'">工号类别</th>
            	<th data-options="field:'proEngineTypeName',width:100,align:'center',sortable:'true'">工程类别</th>
            	<th data-options="field:'proNatureName',width:100,align:'center',sortable:'true'">工程性质</th>
            	<th data-options="field:'proSourceName',width:100,align:'center',sortable:'true'">工程来源</th>
            	<th data-options="field:'proLssuedTime',width:150,align:'center',sortable:'true'">任务下达时间</th>
            	<th data-options="field:'proAreaName',width:100,align:'center',sortable:'true'">工程地址</th>
            	<th data-options="field:'proRoadsTime',width:150,align:'center',sortable:'true'">路政报批时间</th>
            	<th data-options="field:'proTrafficTime',width:150,align:'center',sortable:'true'">交通报批时间</th>
            	<th data-options="field:'proPeriodName',width:100,align:'center',sortable:'true'">期次</th>
            	<th data-options="field:'proConstName',width:100,align:'center',sortable:'true'">施工单位</th>
            	<th data-options="field:'proDeptName',width:100,align:'center',sortable:'true'">转入单位</th>
            	<th data-options="field:'proDesignLength',width:100,align:'center',sortable:'true'">设计长度</th>
            	<th data-options="field:'proPipeLength',width:100,align:'center',sortable:'true'">管径</th>
            	<th data-options="field:'proSnapLength',width:100,align:'center',sortable:'true'">临时线长度</th>
            	<th data-options="field:'createUser',width:100,align:'center',sortable:'true'">创建人</th>
            	<th data-options="field:'createTime',width:150,align:'center',sortable:'true'">创建时间</th> -->
            	
            </tr>
        </thead>
   	</table>
    <div id="toolbar2" class="easyui-layout" style="height:40px;margin:3px;">
        <div data-options="region:'north',border:true" style="height:40px;">
            <form id="fm" method="post" novalidate>
            <table cellpadding="5">
              <tr>
                   <td>项目名称:</td>
                   <td><input class="easyui-validatebox textbox" type="text" name="pname" id="pname"></input></td>
                   <td><a href="javascript:searchProp()" class="easyui-linkbutton" iconCls="icon-search">查找</a></td>
               </tr>
           </table>
           </form>
        </div>
        
    </div>
	<table id="tb1" class="easyui-datagrid" title="" style="width:1260px;height:255px;"  border="0"
           data-options="rownumbers:true,pagination:true,url:'',singleSelect:false,method:'get',toolbar:'#toolbar1'">
        <thead>
            <tr>
            	<th data-options="field:'ck',checkbox:true"></th>
            	<th data-options="field:'id',width:100,align:'center',sortable:'true',hidden:'true'">id</th>
            	<th data-options="field:'proId',width:100,align:'center',sortable:'true',hidden:'true'">proId</th>
            	
            	<th data-options="field:'prHead',width:100,align:'center',sortable:'true'">勾头</th>
            	<th data-options="field:'prRinse',width:100,align:'center',sortable:'true'">冲洗</th>
            	<th data-options="field:'prConstru',width:100,align:'center',sortable:'true'">砌井</th>
            	<th data-options="field:'prTube',width:100,align:'center',sortable:'true'">穿管</th>
            	<th data-options="field:'prTubeNext',width:100,align:'center',sortable:'true'">穿管(下)</th>
            	<th data-options="field:'prLining',width:100,align:'center',sortable:'true'">内衬</th>
            	<th data-options="field:'prLiningNext',width:100,align:'center',sortable:'true'">内衬(下)</th>
            	<th data-options="field:'prEnca',width:100,align:'center',sortable:'true'">包封</th>
            	<th data-options="field:'prEncaNext',width:100,align:'center',sortable:'true'">包封(下)</th>
            	
            	
            	
            	
            	
            	<th data-options="field:'prwdOne',width:100,align:'center',sortable:'true'">DN15(防止器)</th>
            	<th data-options="field:'prwdTwo',width:100,align:'center',sortable:'true'">DN20(防止器)</th>
            	<th data-options="field:'prwdThree',width:100,align:'center',sortable:'true'">DN25(防止器)</th>
            	<th data-options="field:'prwdFour',width:100,align:'center',sortable:'true'">DN40(防止器)</th>
            	<th data-options="field:'prwdFive',width:100,align:'center',sortable:'true'">DN50(防止器)</th>
            	<th data-options="field:'prwdSix',width:100,align:'center',sortable:'true'">DN75(防止器)</th>
            	<th data-options="field:'prwdSeven',width:100,align:'center',sortable:'true'">DN100(防止器)</th>
            	<th data-options="field:'prwdEight',width:100,align:'center',sortable:'true'">DN150(防止器)</th>
            	<th data-options="field:'prwdNine',width:100,align:'center',sortable:'true'">DN200(防止器)</th>
            	<th data-options="field:'prwdSubtotal',width:100,align:'center',sortable:'true'">小计(防止器)</th>
            	<!-- <th data-options="field:'createUser',width:100,align:'center',sortable:'true'">创建人</th> -->
            	<th data-options="field:'createTime',width:150,align:'center',sortable:'true'">创建时间</th>
            	<th data-options="field:'prDmaOne',width:100,align:'center',sortable:'true'">DN15(DMA)</th>
            	<th data-options="field:'prDmaTwo',width:100,align:'center',sortable:'true'">DN20(DMA)</th>
            	<th data-options="field:'prDmaThree',width:100,align:'center',sortable:'true'">DN25(DMA)</th>
            	<th data-options="field:'prDmaFour',width:100,align:'center',sortable:'true'">DN40(DMA)</th>
            	<th data-options="field:'prDmaFive',width:100,align:'center',sortable:'true'">DN50(DMA)</th>
            	<th data-options="field:'prDmaSix',width:100,align:'center',sortable:'true'">DN75(DMA)</th>
            	<th data-options="field:'prDmaSeven',width:100,align:'center',sortable:'true'">DN100(DMA)</th>
            	<th data-options="field:'prDmaEight',width:100,align:'center',sortable:'true'">DN150(DMA)</th>
            	<th data-options="field:'prDmaNine',width:100,align:'center',sortable:'true'">DN200(DMA)</th>
            	<th data-options="field:'prDmaSubtotal',width:100,align:'center',sortable:'true'">小计(DMA)</th>
            	
            	<th data-options="field:'prwdOneNext',width:100,align:'center',sortable:'true'">DN15(次)(防止器)</th>
            	<th data-options="field:'prwdTwoNext',width:100,align:'center',sortable:'true'">DN20(次)(防止器)</th>
            	<th data-options="field:'prwdThreeNext',width:100,align:'center',sortable:'true'">DN25(次)(防止器)</th>
            	<th data-options="field:'prwdFourNext',width:100,align:'center',sortable:'true'">DN40(次)(防止器)</th>
            	<th data-options="field:'prwdFiveNext',width:100,align:'center',sortable:'true'">DN50(次)(防止器)</th>
            	<th data-options="field:'prwdSixNext',width:100,align:'center',sortable:'true'">DN75(次)(防止器)</th>
            	<th data-options="field:'prwdSevenNext',width:100,align:'center',sortable:'true'">DN100(次)(防止器)</th>
            	<th data-options="field:'prwdEightNext',width:100,align:'center',sortable:'true'">DN150(次)(防止器)</th>
            	<th data-options="field:'prwdNineNext',width:100,align:'center',sortable:'true'">DN200(次)(防止器)</th>
            	<th data-options="field:'prwdSubtotalNext',width:100,align:'center',sortable:'true'">小计(次)(防止器)</th>
            	
            	<th data-options="field:'prDmaOneNext',width:100,align:'center',sortable:'true'">DN15(次)(DMA)</th>
            	<th data-options="field:'prDmaTwoNext',width:100,align:'center',sortable:'true'">DN20(次)(DMA)</th>
            	<th data-options="field:'prDmaThreeNext',width:100,align:'center',sortable:'true'">DN25(次)(DMA)</th>
            	<th data-options="field:'prDmaFourNext',width:100,align:'center',sortable:'true'">DN40(次)(DMA)</th>
            	<th data-options="field:'prDmaFiveNext',width:100,align:'center',sortable:'true'">DN50(次)(DMA)</th>
            	<th data-options="field:'prDmaSixNext',width:100,align:'center',sortable:'true'">DN75(次)(DMA)</th>
            	<th data-options="field:'prDmaSevenNext',width:100,align:'center',sortable:'true'">DN100(次)(DMA)</th>
            	<th data-options="field:'prDmaEightNext',width:100,align:'center',sortable:'true'">DN150(次)(DMA)</th>
            	<th data-options="field:'prDmaNineNext',width:100,align:'center',sortable:'true'">DN200(次)(DMA)</th>
            	<th data-options="field:'prDmaSubtotalNext',width:100,align:'center',sortable:'true'">小计(次)(DMA)</th>
            	
            	
            	<th data-options="field:'prwOne',width:100,align:'center',sortable:'true'">DN15(长度)</th>
            	<th data-options="field:'prwTwo',width:100,align:'center',sortable:'true'">DN20(长度)</th>
            	<th data-options="field:'prwThree',width:100,align:'center',sortable:'true'">DN25(长度)</th>
            	<th data-options="field:'prwFour',width:100,align:'center',sortable:'true'">DN40(长度)</th>
            	<th data-options="field:'prwFive',width:100,align:'center',sortable:'true'">DN50(长度)</th>
            	<th data-options="field:'prwSix',width:100,align:'center',sortable:'true'">DN75(长度)</th>
            	<th data-options="field:'prwSeven',width:100,align:'center',sortable:'true'">DN100(长度)</th>
            	<th data-options="field:'prwEight',width:100,align:'center',sortable:'true'">DN150(长度)</th>
            	<th data-options="field:'prwNine',width:100,align:'center',sortable:'true'">DN200(长度)</th>
            	<th data-options="field:'prwSubtotal',width:100,align:'center',sortable:'true'">小计(长度)</th>
            	
            	<th data-options="field:'prwOneNext',width:100,align:'center',sortable:'true'">DN15(次)(长度)</th>
            	<th data-options="field:'prwTwoNext',width:100,align:'center',sortable:'true'">DN20(次)(长度)</th>
            	<th data-options="field:'prwThreeNext',width:100,align:'center',sortable:'true'">DN25(次)(长度)</th>
            	<th data-options="field:'prwFourNext',width:100,align:'center',sortable:'true'">DN40(次)(长度)</th>
            	<th data-options="field:'prwFiveNext',width:100,align:'center',sortable:'true'">DN50(次)(长度)</th>
            	<th data-options="field:'prwSixNext',width:100,align:'center',sortable:'true'">DN75(次)(长度)</th>
            	<th data-options="field:'prwSevenNext',width:100,align:'center',sortable:'true'">DN100(次)(长度)</th>
            	<th data-options="field:'prwEightNext',width:100,align:'center',sortable:'true'">DN150(次)(长度)</th>
            	<th data-options="field:'prwNineNext',width:100,align:'center',sortable:'true'">DN200(次)(长度)</th>
            	<th data-options="field:'prwSubtotalNext',width:100,align:'center',sortable:'true'">小计(次)(长度)</th>
            </tr>
        </thead>
   	</table>
    <div id="toolbar1" class="easyui-layout" style="height:30px;margin:3px;">
        <div data-options="region:'center',border:false">
        <a th:each="but : ${buttons}" th:shiro:hasPermission="${but.resurl}" th: class="easyui-linkbutton" th:icon="${but.iconCls}" plain="true" th:href="|javascript:${but.butFun};|" th:text="${but.name}"></a>
        </div>
        <!-- <div data-options="region:'north',border:true" style="height:1px;">
            <form id="fm" method="post" novalidate>
            <table cellpadding="5">
              <tr>
                   <td>菜单名称:</td>
                   <td><input class="easyui-validatebox textbox" type="text" name="name" id="name"></input></td>
                   <td><a href="javascript:search()" class="easyui-linkbutton" iconCls="icon-search">查找</a></td>
               </tr>
           </table>
           </form>
        </div>  -->
        
    </div> 
    <script th:inline="javascript">
    var menuName=[[${menuName}]]
    
    $(function(){ 
    	$('#tb2').datagrid({
    	onClickRow:function(rowIndex,rowData){
    		search();
    	}
    	});
    	});
    
    function add(){
    	var selecteds = $('#tb2').datagrid('getSelections');
        if (selecteds == null || selecteds.length == 0) { 
        	Common.showMsg('提示','请选一条数据');
        	return;
        }
        if (selecteds.length>1) {
        	Common.showMsg('提示','不支持多个操作！');
        	return; 
        }
		top.framework.openTab('新增数据', '/workdailys/add?menuName=新增数据&parentMenuName='+menuName+'&proId='+selecteds[0].proId+'&pcId='+selecteds[0].pcId);
	}
    function edit(){
		var selecteds = $('#tb1').datagrid('getSelections');
        if (selecteds == null || selecteds.length == 0) { 
        	Common.showMsg('修改数据','请选择操作项！');
        	return;
        }
        if (selecteds.length>1) {
        	Common.showMsg('修改数据','不支持多个操作！');
        	return; 
        }
		top.framework.openTab('修改数据', '/workdailys/add.do?menuName=修改数据&id='+selecteds[0].id+'&parentMenuName='+menuName);
	}
    
    function remove(){
		var selecteds = $('#tb1').datagrid('getSelections');
        if (selecteds == null || selecteds.length == 0) { 
        	Common.showMsg('提示','请选择操作项！');
        	return;
        }
        $.messager.confirm('提示','确定删除吗?', 
        function(r){
            if (r){
            	var ids = '';
                $(selecteds).each(function (index) {
                    ids = ids + selecteds[index].id + ",";
                });
                ids = ids.substring(0, ids.length - 1);
        		$.ajax( {
    				url : '/workdailys/delete.do?ids='+ids,
    				dataType:'text',
    				type: 'delete',
    				success : function(result) {
    					if ("success"==result){
    						Common.showMsg('提示',"删除成功");
        				    search();
    					}else{
    						Common.showMsg('提示',"删除失败");
    					}
    					
    				}
    			});
            }
        });
        
	}
    function search(){
    	var selecteds = $('#tb2').datagrid('getSelections');
    	var names = $("#name").val();
		$('#tb1').datagrid({
            url:"/workdailys/getData.do",
            queryParams:{
            	pcId:selecteds[0].pcId
            }
        });
	}
    function searchProp(){
    	var names = $("#pname").val();
		$('#tb2').datagrid({
            url:"/workdailys/getItemData.do",
            queryParams:{
            	proName:names
            }
        });
	}
    </script>
</body>

